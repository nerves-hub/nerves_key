defmodule ATECC508A.CRCTest do
  use ExUnit.Case

  alias ATECC508A.CRC

  test "verify test vectors" do
    # These were computed using the atca_calculate_crc() C code
    # in the cryptoauthlib.
    assert CRC.crc(<<>>) == <<0x00, 0x00>>
    assert CRC.crc(<<0x80>>) == <<0x05, 0x80>>
    assert CRC.crc(<<0x01>>) == <<0x03, 0x83>>
    assert CRC.crc(<<0x91>>) == <<0x35, 0x83>>
    assert CRC.crc(<<0x01, 0x02, 0x03, 0x04>>) == <<0xF0, 0x85>>
    assert CRC.crc(<<0xFF, 0xFE, 0xFD, 0x01>>) == <<0x2D, 0x0B>>

    assert CRC.crc(
             <<0x67, 0xC6, 0x69, 0x73, 0x51, 0xFF, 0x4A, 0xEC, 0x29, 0xCD, 0xBA, 0xAB, 0xF2, 0xFB,
               0xE3, 0x46>>
           ) == <<0x81, 0xA4>>
  end
end
